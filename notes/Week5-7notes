Chapter 11: Data Science Tools for Neuroimaging

 Neuroimaging in Python (NiPy)
  -	Collection of Python-based tools specifically developed for neuroimaging research, covering a wide range of data analysis tasks.

Reading and Writing Data
  -	 Nibabel is the foundational library used to read and write common neuroimaging file formats into computer memory. It serves a similar role for NiPy as Numpy does for general scientific computing 

MRI Data Analysis Tools
  -	Functional MRI (fMRI): Tools like BrainIAK and Nilearn focus on machine learning analysis, while fitlins and glmsingle are used for Generalized Linear Models (GLM)
  -	Diffusion MRI (dMRI): DIPY (Diffusion Imaging in Python) provides the core algorithms for white matter analysis. Specialized tools built on DIPY include DMIPY (microstructure modeling), pyAFQ (tract delineation), and NDMG (connectivity matrices).
  -	Structural MRI: The Advanced Normalization Tools (ANTs) library handles image registration and segmentation, accessible in Python via antspy.

Other Modalities
  -	MNE is the primary project for electrophysiology data, supporting MEG, EEG, and ECoG analysis, including frequency spectrums and source localization

Pipeline Unification with Nipype
  -	Nipype provides a uniform Python interface to various software libraries, including non-Python tools like FSL, AFNI, and FreeSurfer
  -	It allows researchers to create reproducible pipelines where outputs of one step automatically become inputs for the next. 

The Brain Imaging Data Structure (BIDS)
  -	BIDS is a community-developed standard for organizing neuroimaging data and metadata to ensure it is both machine-readable and human-readable.

The BIDS Specification
  -	Folder structure: Data is organized hierarchically: sub-[id]/[modality]
  -	Naming Conventions: Filenames use a sequence of key-value pairs separated by underscores and a specific “suffix” to describe the data type.
  -	Metadata: Every data file is accompanied by a JSON ‘sidecar” file containing metadata, following an “inheritance principle” where metadata at higher levels applies to lower level unless overridden. 
  -	BIDS Derivatives: This extension defines how to organize data that has been transformed or preprocessed, ensuring the relationship between raw and processed data remains clear

The BIDS Ecosystem
  -	Data Sharing: Repos like OpenNeuro use BIDS to automatically index meta data and make sharing/re-using datasets significantly easier.
  -	BIDS Apps: These are containerized applications-such as fMRIPrep for preprocessing and MRIQC for quality control, that take BIDS datasets as input and run with minimal manual configuration
  -	Utility Libraries: PyBIDS is a Python package used to programmatically query and manipulate BIDS datasets

Chapter 12: Reading Neuroimaging Data with Nibabel
-	The first step in neuroimaging analysis is reading data from files
-	Many formats exists, but the most common is NIfTI (Neuroimaging Informatics Technology Initiative)
  o	Widely adopted
  o	Required by the Brain Imaging Data Structure (BIDS) standard for raw MRI data
  o	Supported by the Python library nibabel 

Important Design Principle of Nibabel 
  -	Nibabel uses lazy loading:
    o	Only reads the header initially
    o	Does NOT load full data into memory immediately 
    o	Saves memory and computation time

What is in the header?
  -	Metadata
  -	Shape of data
  -	Voxel size
  -	Data type
  -	Affine transformation info 

Reading the Actual Data
  -	Get_fdata():
    o	Loads full data into memory
    o	Coverts to 64-bit floating point
    o	Works correctly in ~99% of cases

Assessing MRI Data Quality
  -	MRI data quality varies significantly
  -	Common issues
    o	Motion artifacts
    o	Scanner noise
    o	Population differences
  -	Poor data quality can lead to incorrect conclusions

Temporal Signal-to-Noise Ratio (tSNR)
  -	Definition: mean signal across time / standard deviation across time
  -	For each voxel
    o	Compute mean across time
    o	Divide by standard deviation across time
  -	Higher tSNR = better signal stability

Method 1: Using NumPy
  -	Produces a 3D volume of tSNR values

Method 2: Using Nipype
  -	Provides interfaces to many neuroimaging tools
  -	Wraps neuroimaging tools
  -	Produces output files (not just arrays)
  -	Useful for building pipeline

Method 3: Using MRIQC (BIDS App)
  -	MRIQC is a BIDS App distributed via Docker
  -	What happens
    o	MRIQC reads BIDS dataset
    o	Computes multiple quality metrics
    o	Outputs a derivatives BIDS dataset

MRIQC Output Structure
  -	Outputs follow BIDS derivatives format
  -	JSON files contain:
    o	Median tSNR
    o	Motion metrics
    o	May other QC metrics
  -	HTML files contain:
    o	Visual diagnostics

Why is BIDS Important
  -	Without BIDS
    o	MRIQC wouldn’t know where to find data
    o	Outputs wouldn’t be organized predictably
    o	Automations would be much harder
  -	BIDS enables
    o	Standarized data structures
    o	Interoperability
    o	Reproducibility automation
